using .FTOtto
using Plots
using ColorSchemes
using Printf

X = FTOtto.Init_Parameters(r_compr = 13, MODELOS = "FTAS", Fluido = "C4H10", œï = 0.0005, Half_lifes = 10, Y_FRAC = "iK", Œ± = 0.05, q_ent = 1000)

Y = FTOtto.Initialization(X, FTOtto.œµ)

FTOtto.cFTASik(Y)

MODEL = FTOtto.RESULTS(Y)

X1 = FTOtto.Init_Parameters(r_compr = 13, MODELOS = "FTHA", Fluido = "O2", Half_lifes = 10, Œ± = 0.05, q_ent = 1000, Œît_comb = 0.000109587)

Y1 = FTOtto.Initialization(X1)

FTOtto.FTHA(Y1)

FTHA_MODEL = FTOtto.RESULTS(Y1)

FTOtto.TABLES(MODEL, FTHA_MODEL)

logP_Ftas_ik = [log(i) for i in Y["SIMUL"]["P"]]
logv_Ftas_ik = [log(i) for i in Y["SIMUL"]["ùïß"]]
logP_FTHA = [log(i) for i in Y1["SIMUL"]["P"]]
logv_FTHA = [log(i) for i in Y1["SIMUL"]["ùïß"]]

scheme = [cgrad(:fes25)[2], cgrad(:fes25)[5]]

a = plot(logv_Ftas_ik, logP_Ftas_ik, xlabel = "v [m¬≥/kg]", ylabel = "P [kPa] ", label = "FTAS-IK, Œ¥ = "*@sprintf("%.2f", Y["INPUT"]["Œ¥"])*"¬∞, Œ∑ = "*@sprintf("%.2f", MODEL["Œ∑_t"]*100)*"%", palette=scheme)
plot!(a, logv_FTHA, logP_FTHA, marker=:plus, label = "FTHA, Œ¥ = "*@sprintf("%.2f", Y1["INPUT"]["Œ¥"])*"¬∞, Œ∑ = "*@sprintf("%.2f", FTHA_MODEL["Œ∑_t"]*100)*"%")
savefig(a, "C:\\Users\\gabri\\Desktop\\Article-Figures\\ValidationFTASik-FTHA.png")